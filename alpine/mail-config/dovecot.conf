# Dovecot configuration for Alpine Linux
protocols = imap lmtp
listen = *

# Mail location - using standard Alpine Linux path
mail_location = maildir:/var/spool/mail/vhosts/%d/%n
mail_privileged_group = postdrop

# Authentication
auth_mechanisms = plain login
disable_plaintext_auth = no

# Static user configuration for virtual domains
userdb {
  driver = static
  args = uid=vmail gid=postdrop home=/var/spool/mail/vhosts/%d/%n
}

# Simple password authentication for testing
passdb {
  driver = static
  args = password=password
}

# IMAP service
service imap-login {
  inet_listener imap {
    port = 143
  }
}

# LMTP service for Postfix delivery
service lmtp {
  unix_listener /var/spool/postfix/private/dovecot-lmtp {
    group = postfix
    mode = 0600
    user = postfix
  }
}

# Auth service for Postfix SASL
service auth {
  unix_listener /var/spool/postfix/private/auth {
    group = postfix
    mode = 0660
    user = postfix
  }
}

# SSL configuration (disabled for local testing)
ssl = no

# Namespace configuration
namespace inbox {
  inbox = yes
  location = 
  mailbox INBOX {
    auto = subscribe
  }
}

# Logging
log_path = /var/log/dovecot.log
info_log_path = /var/log/dovecot-info.log