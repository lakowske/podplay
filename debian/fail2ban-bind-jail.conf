# Fail2Ban jail configuration for BIND DNS
# Add this to /etc/fail2ban/jail.local or jail.d/bind.conf

[bind-dns-abuse]
enabled = true
filter = bind-dns-abuse
action = iptables-multiport[name=bind-dns, port="53", protocol=udp]
         iptables-multiport[name=bind-dns-tcp, port="53", protocol=tcp]
# Access logs from the podman volume mount point
logpath = /home/seth/.local/share/containers/storage/volumes/logs/_data/bind/general.log
          /home/seth/.local/share/containers/storage/volumes/logs/_data/bind/security.log
maxretry = 5
findtime = 300
bantime = 3600
ignoreip = 127.0.0.1/8 ::1

# Stricter jail for ANY query abuse
[bind-any-abuse]
enabled = true
filter = bind-dns-abuse
action = iptables-multiport[name=bind-any, port="53", protocol=udp]
         iptables-multiport[name=bind-any-tcp, port="53", protocol=tcp]
logpath = /home/seth/.local/share/containers/storage/volumes/logs/_data/bind/general.log
maxretry = 3
findtime = 60
bantime = 7200
ignoreip = 127.0.0.1/8 ::1

# IMPORTANT: Since containers use pod networking, external IPs appear as pod gateway (10.89.0.17)
# This configuration won't be effective until BIND is configured with host networking
# to expose real client IPs. Consider switching BIND container to use host networking.