# Fail2Ban jail configuration for Apache HTTP abuse
# Add this to /etc/fail2ban/jail.local or jail.d/apache.conf

[apache-wordpress]
enabled = true
filter = apache-wordpress
action = iptables-multiport[name=apache-wp, port="http,https", protocol=tcp]
logpath = /home/seth/.local/share/containers/storage/volumes/logs/_data/apache/access.log
maxretry = 3
findtime = 300
bantime = 3600
ignoreip = 127.0.0.1/8 ::1

# Aggressive jail for environment file probes
[apache-envprobe]
enabled = true
filter = apache-wordpress
action = iptables-multiport[name=apache-env, port="http,https", protocol=tcp]
logpath = /home/seth/.local/share/containers/storage/volumes/logs/_data/apache/access.log
maxretry = 1
findtime = 60
bantime = 7200
ignoreip = 127.0.0.1/8 ::1

# General HTTP abuse jail
[apache-general]
enabled = true
filter = apache-wordpress
action = iptables-multiport[name=apache-gen, port="http,https", protocol=tcp]
logpath = /home/seth/.local/share/containers/storage/volumes/logs/_data/apache/access.log
maxretry = 5
findtime = 600
bantime = 1800
ignoreip = 127.0.0.1/8 ::1